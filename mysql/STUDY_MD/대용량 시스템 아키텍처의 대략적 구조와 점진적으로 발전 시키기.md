# 한번 대용량 시스템의 아키텍처는 어떤 모습인지, 점진적으로 시스템을 발전해보자

1. 클라이언트 -> 서버 -> DB
    - 서버의 처리가 점점 늦어져서 서버 스케일아웃 진행
2. 클라이언트 -> 로드밸런서(e.x. Nginx, RR ...) -> 서버 여러대 -> DB
    - DB가 느려져서 전체 서비스 응답속도가 느려지면.
        - 쿼리 튜닝, 등 다른 최적화 기법이 있지만, 아키텍처먼저 살펴보자
3. 클라이언트 -> 로드밸런서(e.x. Nginx, RR ...) -> 서버 여러대 -> 캐시 DB, DB
    - 캐시를 적용할 때는 **글로벌 캐시인지, 로컬 캐시인지 부터 정해야** 한다
        - 로컬 캐시는 각 서버 메모리에 데이터를 캐싱 하는 것
        - 글로벌 캐시는 Redis 같은 걸 이용해서 여러 서버가 하나의 캐시를 공유할 수 있게
    - **캐시 주기를 어떻게** 가져갈 것인가, **만료 정책은 어떻게** 할 것인가를 고려해야함
    - 서비스가 점점 커지면서 우리 서버에서 해결할 수없는 (e.x. 이메일, 알람 ...) 대외 기관과의 연동이 필요해졌고,
    - 우리 서버는 응답속도가 빠른데, **대외기관 응답이 느려짐**
4. 클라이언트 -> 로드밸런서(e.x. Nginx, RR ...) -> 서버 여러대 -> 캐시 DB, DB,  비동키 큐 <- 대외 기관
    - 대외기관도 캐시를 적용할 수있지만
    - 비동기 큐로 해소할 수 있다. (e.x. kafka, rabbitMQ...)
    - 하나의 서버 내에서 스레드 풀을 사용해서 비동기 큐를 사용할 수 있다.
    - 클라이언트의 요청중 대외 기관 연동 트랜잭션 부분을 요청에서 제외하는 것
        - 클라이언트는 대외 기관의 느린 응답 안 기다려도 되고
        - 대외 기관이 받을 수있는 적정 TPS에 맞춰 조절 할 수 도 있다.

---
이런 여러개의 모듈이 모여서 점점 확장 할 수 있다.